@startuml

object ユーザ {
    ID
    --
    ユーザ名
    削除日時
    登録日時
    更新日時
}

object ディレクトリ {
    ID
    --
    ディレクトリ名
    親ディレクトリID（FK）
    更新者ユーザID（FK）
    削除日時
    登録日時
    更新日時
}

object ドキュメント {
    ID
    --
    ドキュメント名
    ドキュメント内容
    ディレクトリID（FK）
    更新者ユーザID（FK）
    削除日時
    登録日時
    更新日時
}

object ドキュメント履歴 {
    ID
    --
    ドキュメントID（FK）
    世代番号
    ドキュメント名
    ドキュメント内容
    ディレクトリID（FK）
    更新者ユーザID（FK）
    削除日時
    登録日時
    更新日時
}

note right of ドキュメント履歴
ドキュメントテーブルの更新をトリガとして
更新前のドキュメントテーブルの情報をコピーして保持する。
世代番号は採番済みのもの+1を新たな世代番号として採番する。
end note

ユーザ --{ ディレクトリ
ユーザ --{ ドキュメント
ユーザ --{ ドキュメント履歴
ディレクトリ --{ ディレクトリ
ディレクトリ --{ ドキュメント
ディレクトリ --{ ドキュメント履歴
ドキュメント --{ ドキュメント履歴

@enduml
